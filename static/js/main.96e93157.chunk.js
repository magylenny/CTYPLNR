(this.webpackJsonpuntitled6=this.webpackJsonpuntitled6||[]).push([[0],{264:function(e,t,a){e.exports=a(471)},471:function(e,t,a){"use strict";a.r(t);var n,r,o,l,c=a(0),i=a.n(c),s=a(35),u=a.n(s),m=a(29),p=a(30),d=a(32),h=a(31),g=a(33),b=a(165),y=a(166),f=a(164),E=(a(269),a(89),a(270),a(232)),v=a.n(E),C=function(e){function t(){return Object(m.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return i.a.createElement(v.a,{type:"Oval",color:"deepskyblue",height:300,width:300})}}]),t}(i.a.Component),k=a(481),O=a(482),S=a(483),D=a(114),j=a.n(D),P=function(e){function t(){return Object(m.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return i.a.createElement(j.a,{position:"bottomright",classname:!0},i.a.createElement(k.a,{inverted:!0,style:{background:"#243665",height:"110px"}},i.a.createElement(O.a,{color:"black",inverted:!0},i.a.createElement(O.a.Content,{style:{color:"deepskyblue"}},"Travel times in minutes")),i.a.createElement(S.a,{columns:"equal",style:{width:"340px"},padded:!0},i.a.createElement(S.a.Column,{style:{background:"navy"}},"0 - 1"),i.a.createElement(S.a.Column,{style:{background:"royalblue"}},"1 - 2"),i.a.createElement(S.a.Column,{style:{background:"seagreen"}},"2 - 3"),i.a.createElement(S.a.Column,{color:"yellow"},"3 - 4"),i.a.createElement(S.a.Column,{style:{background:"darkorange"}},"4 - 5"),i.a.createElement(S.a.Column,{style:{background:"maroon"}},"5+"))))}}]),t}(i.a.Component),w=a(122),F=a.n(w),N=a(477),T=a(480),G=a(76),z=a(479),Z=a(86),x=a.n(Z),M=a(156),A=a.n(M),I=a(84),_=[{key:"GP",text:"GP",value:"GP",style:{color:"deepskyblue",background:"#243665",borderColor:"deepskyblue"}},{key:"Primary School",text:"Primary School",value:"PrimarySchool",style:{color:"deepskyblue",background:"#243665",borderColor:"deepskyblue"}},{key:"Secondary School",text:"Secondary School",value:"SecondarySchool",style:{color:"deepskyblue",background:"#243665",borderColor:"deepskyblue"}},{key:"Post Office",text:"Post Office",value:"PostOffice",style:{color:"deepskyblue",background:"#243665",borderColor:"deepskyblue"}},{key:"Shopping Facility",text:"Shopping Facility",value:"ShoppingFacilities",style:{color:"deepskyblue",background:"#243665",borderColor:"deepskyblue"}}],U=[],B={},J=[],R={},q=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).handleOpen=function(){return a.setState({modalOpen:!0})},a.handleFacilityChange=function(e,t){a.setState({addFacility:t.value})},a.handleDataZoneChange=function(e,t){a.setState({addDataZone:t.value})},a.handleClose=function(e){var t,n,r,o,l,c;return F.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:a.setState({modalOpen:!1}),t=parseInt(a.state.addDataZone.substr(1)),(n=[]).push(B[t]),r=I.polygon(n),o=A()(r),l=a.getNeighbours(),c=a.getCoordinates(l),a.calculateTravelTimes(o,c,e);case 9:case"end":return i.stop()}}))},a.getNeighbours=function(){var e,t=new Set,n=parseInt(a.state.addDataZone.substr(1));e=B[n];for(var r=-100;r<100;r++){var o=n+r;if(o in B&&"S0"+o!=a.state.addDataZone)for(var l=0;l<e.length;l++)JSON.stringify(B[o]).includes(JSON.stringify(e[l]))&&t.add("S0"+o)}return Array.from(t)},a.getCoordinates=function(e){for(var t,a,n,r=[],o={},l=0;l<e.length;l++){t=e[l];var c=parseInt(t.substr(1));r.push(B[c]),a=I.polygon(r),n=A()(a),o[t]=n}return o},a.calculateTravelTimes=function(e,t,n){var r,o,l;return F.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:for(l in J=[],R={},r={headers:{"Content-Type":"application/json",Accept:"application/json","X-Application-Id":"cd8dab5e","X-Api-Key":"3b67e6f052bc7121e2f6bcb917024443"}},o=function(a){var n={locations:[{id:"Facility",coords:{lat:e.geometry.coordinates[1],lng:e.geometry.coordinates[0]}},{id:"DataZone centroid",coords:{lat:t[a].geometry.coordinates[1],lng:t[a].geometry.coordinates[0]}}],departure_searches:[{id:"departure search example",departure_location_id:"Facility",arrival_location_ids:["DataZone centroid"],transportation:{type:"driving"},departure_time:"2020-02-20T10:00:00Z",properties:["travel_time","distance","route"]}]};J.push(x.a.post("https://crossorigin.me/http://api.traveltimeapp.com/v4/routes",n,r).then((function(e){var t=e.data.results[0].locations[0].properties[0].travel_time/60,n=Math.round(10*t)/10;R[a]=n})).catch((function(e){console.log("AXIOS ERROR: ",e)})))},t)o(l);Promise.all(J).then((function(){return a.checkChanges(R,n)}));case 6:case"end":return c.stop()}}))},a.checkChanges=function(e,t){var n,r;return F.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:for(n in console.log("most leptem be"),e)for(r=0;r<t.features.length;r++)t.features[r].properties.DataZone===n?t.features[r].properties.CarTravelTimes[a.state.addFacility]>e[n]&&(t.features[r].properties.CarTravelTimes[a.state.addFacility]=e[n]):t.features[r].properties.DataZone===a.state.addDataZone&&(t.features[r].properties.CarTravelTimes[a.state.addFacility]="1.0");console.log("checkchanges finished"),a.props.parentCallback(t);case 4:case"end":return o.stop()}}))},a.populateDropdown=function(e){for(var t,a,o=0;o<e.features.length;o++)n=e.features[o].properties,r=n.Name+" ("+n.DataZone+")",U[o]={key:r,text:r,value:n.DataZone,style:{color:"deepskyblue",background:"#243665",borderColor:"deepskyblue"}},t=parseInt(n.DataZone.substr(1)),a=e.features[o].geometry.coordinates[0],B[t]=a;return U},a.state={modalOpen:!1,addFacility:"",addDataZone:""},a}return Object(g.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props.geo;return i.a.createElement(j.a,{position:"topright"},i.a.createElement(N.a,{size:"tiny",trigger:i.a.createElement(T.a,{onClick:this.handleOpen,style:{color:"deepskyblue",background:"#243665"},circular:!0,icon:!0}," ",i.a.createElement(G.a,{name:"plus",size:"large"}),"   "),onClose:this.handleClose,open:this.state.modalOpen},i.a.createElement(N.a.Header,{className:"modalHeader"},i.a.createElement("p",null,"Adding facility")),i.a.createElement(N.a.Content,{className:"modalContent"},i.a.createElement(i.a.Fragment,null,i.a.createElement(z.a,{className:"modalDropdown",placeholder:"Select Facility",fluid:!0,selection:!0,onChange:this.handleFacilityChange,options:_}),i.a.createElement("br",null),i.a.createElement(z.a,{className:"modalDropdown",placeholder:"Select Data Zone",fluid:!0,search:!0,selection:!0,onChange:this.handleDataZoneChange,options:this.populateDropdown(t)}))),i.a.createElement(N.a.Actions,{className:"modalAction"},i.a.createElement(T.a,{className:"modalButton",onClick:function(){return e.handleClose(t)},positive:!0,labelPosition:"right",icon:"checkmark",content:"Done"}))))}}]),t}(i.a.Component),X=a(252),H=function(e){function t(){return Object(m.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e,t=this,a=this.props.activeDomains;return e="Car"===this.props.method,i.a.createElement(X.a,null,i.a.createElement("div",{className:"side-bar-container"},e?i.a.createElement("div",null,i.a.createElement(T.a.Group,{inverted:!0,vertical:!0,icon:!0,color:"blue",size:"big",className:"side-bar"},i.a.createElement(T.a,{active:a.City,icon:!0,onClick:function(){return t.props.changeDomain("City")}},i.a.createElement(G.a,{name:"globe",size:"big"}),i.a.createElement("br",null),i.a.createElement("br",null),"City",i.a.createElement("br",null),"Map"),i.a.createElement(T.a,{active:a.GP,icon:!0,onClick:function(){return t.props.changeDomain("GP")}},i.a.createElement(G.a,{name:"doctor",size:"big"}),i.a.createElement("br",null),i.a.createElement("br",null),"GPs"),i.a.createElement(T.a,{active:a.PrimarySchool,icon:!0,onClick:function(){return t.props.changeDomain("PrimarySchool")}},i.a.createElement(G.a,{name:"building",size:"big"}),i.a.createElement("br",null),i.a.createElement("br",null),"Primary",i.a.createElement("br",null)," Schools"),i.a.createElement(T.a,{active:a.SecondarySchool,icon:!0,onClick:function(){return t.props.changeDomain("SecondarySchool")}},i.a.createElement(G.a,{name:"building",size:"big"}),i.a.createElement("br",null),i.a.createElement("br",null),"Secondary",i.a.createElement("br",null),"Schools"),i.a.createElement(T.a,{active:a.PostOffice,icon:!0,onClick:function(){return t.props.changeDomain("PostOffice")}},i.a.createElement(G.a,{name:"envelope",size:"big"}),i.a.createElement("br",null),i.a.createElement("br",null),"Post",i.a.createElement("br",null)," Offices"),i.a.createElement(T.a,{active:a.ShoppingFacilities,icon:!0,onClick:function(){return t.props.changeDomain("ShoppingFacilities")}},i.a.createElement(G.a,{name:"shop",size:"big"}),i.a.createElement("br",null),i.a.createElement("br",null),"Shopping",i.a.createElement("br",null)," Facilities")),i.a.createElement("div",{className:"restnormal"},i.a.createElement("div",{className:"footer"},i.a.createElement("p",null,"Leonard Magyar - University of Strathcylde 2019/2020")))):i.a.createElement("div",null,i.a.createElement(T.a.Group,{inverted:!0,vertical:!0,icon:!0,color:"blue",size:"big",className:"side-bar"},i.a.createElement(T.a,{active:a.City,icon:!0,onClick:function(){return t.props.changeDomain("City")}},i.a.createElement(G.a,{name:"globe",size:"big"}),i.a.createElement("br",null),i.a.createElement("br",null),"City",i.a.createElement("br",null),"Map"),i.a.createElement(T.a,{active:a.GP,icon:!0,onClick:function(){return t.props.changeDomain("GP")}},i.a.createElement(G.a,{name:"doctor",size:"big"}),i.a.createElement("br",null),i.a.createElement("br",null),"GPs"),i.a.createElement(T.a,{active:a.PostOffice,icon:!0,onClick:function(){return t.props.changeDomain("PostOffice")}},i.a.createElement(G.a,{name:"envelope",size:"big"}),i.a.createElement("br",null),i.a.createElement("br",null),"Post",i.a.createElement("br",null)," Offices"),i.a.createElement(T.a,{active:a.ShoppingFacilities,icon:!0,onClick:function(){return t.props.changeDomain("ShoppingFacilities")}},i.a.createElement(G.a,{name:"shop",size:"big"}),i.a.createElement("br",null),i.a.createElement("br",null),"Shopping",i.a.createElement("br",null)," Facilities")),i.a.createElement("div",{className:"rest"},i.a.createElement("div",{className:"footerrest"},i.a.createElement("p",null,"Leonard Magyar - University of Strathcylde 2019/2020"))))))}}]),t}(i.a.Component),L=function(e){function t(){return Object(m.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return i.a.createElement(S.a.Column,{textAlign:"center",className:"title"},i.a.createElement("div",{className:"header-text"},i.a.createElement("p",null,"City Planner")),i.a.createElement("div",{className:"header-icon"},i.a.createElement(G.a,{inverted:!0,name:"pen square",color:"blue",size:"huge"})))}}]),t}(i.a.Component),K=function(e){function t(){return Object(m.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e,t,a=this;return e="Glasgow"===this.props.city,t="Car"===this.props.method,i.a.createElement("div",{className:"header"},i.a.createElement(S.a,{columns:"equal"},i.a.createElement(S.a.Column,null,i.a.createElement("div",{className:"methodButtons"},i.a.createElement(T.a.Group,{inverted:!0,size:"medium",color:"blue"},i.a.createElement(T.a,{active:t,icon:!0,onClick:function(){return a.props.changeMethod("Car")}},i.a.createElement(G.a,{name:"car",size:"big"}),i.a.createElement("br",null),i.a.createElement("br",null)," Car"),i.a.createElement(T.a.Or,null),i.a.createElement(T.a,{active:!t,icon:!0,onClick:function(){return a.props.changeMethod("PublicTransport")}},i.a.createElement(G.a,{name:"bus",size:"big"}),i.a.createElement("br",null),i.a.createElement("br",null),"Public Transport")))),i.a.createElement(L,null),i.a.createElement(S.a.Column,{textAlign:"right"},i.a.createElement("div",{className:"cityButtons"},i.a.createElement(T.a.Group,{inverted:!0,size:"huge",color:"blue"},i.a.createElement(T.a,{active:e,onClick:function(){return a.props.changeCity("Glasgow")}},"Glasgow"),i.a.createElement(T.a.Or,null),i.a.createElement(T.a,{active:!e,onClick:function(){return a.props.changeCity("Edinburgh")}},"Edinburgh"))))))}}]),t}(i.a.Component),Q=(a(467),a(9)),V=a.n(Q);delete V.a.Icon.Default.prototype._getIconUrl,V.a.Icon.Default.mergeOptions({iconRetinaUrl:a(468),iconUrl:a(469),shadowUrl:a(470)});var W=0,Y=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).callbackFunction=function(e){a.setState({geo:e});a.state.domain;console.log(e.features[9].properties.CarTravelTimes[a.state.domain])},a.getGlasgow=function(){a.setState({isFetching:!0}),x.a.get("https://api.npoint.io/aa3a9094c684db09d0f8").then((function(e){a.setState({isFetching:!1,geo:e.data,domain:"City"})}))},a.changeMethod=function(e){"PublicTransport"!==e||"PrimarySchool"!==a.state.domain&&"SecondarySchool"!==a.state.domain||a.changeDomain("City"),a.setState({method:e})},a.changeDomain=function(e){var t=Object.assign({},a.state);t.activeDomains[a.state.domain]=!1,t.domain=e,t.activeDomains[t.domain]=!0,a.setState(t)},a.changeCity=function(e){var t="";t="Glasgow"===e?"https://api.npoint.io/aa3a9094c684db09d0f8":"https://api.npoint.io/f7c3649ae02eea7f5e92",a.setState({isFetching:!0}),x.a.get(t).then((function(t){a.setState({isFetching:!1,geo:t.data,city:e})})),!0},a.state={isFetching:!0,geo:[],domain:"City",method:"Car",city:"Glasgow",previousDomain:"",activeDomains:{City:!0,GP:!1,PrimarySchool:!1,SecondarySchool:!1,PostOffice:!1,ShoppingFacilities:!1}},a}return Object(g.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){document.title="Glasgow Planner",this.getGlasgow()}},{key:"render",value:function(){console.log("re-rendering...");var e,t=this.state,a=t.isFetching,n=t.geo,r=t.domain,c=t.method;return"Glasgow"===t.city?(o=[55.8595,-4.2518],l=12):(o=[55.933251,-3.268267],l=12),e=a?i.a.createElement("div",{className:"spinner-container"},i.a.createElement(C,null)):i.a.createElement(b.a,{className:"map",minZoom:l,center:o,zoom:l},i.a.createElement(y.a,{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),i.a.createElement(q,{geo:this.state.geo,parentCallback:this.callbackFunction}),i.a.createElement(P,null),i.a.createElement(f.a,{data:n,style:function(e){if("City"===r)return{color:"black",weight:1.5,fillOpacity:.4};W="Car"===c?e.properties.CarTravelTimes[r]:e.properties.PublicTransportTravelTimes[r];return W>=0&&W<1?{color:"navy",weight:1.5}:W>=1&&W<2?{color:"royalblue",weight:1.5,fillOpacity:.5}:W>=2&&W<3?{color:"seagreen",weight:1.5,fillOpacity:.5}:W>=3&&W<4?{color:"yellow",weight:1.5,fillOpacity:.5}:W>=4&&W<5?{color:"orange",weight:1.5,fillOpacity:.5}:W>=5?{color:"maroon",weight:1.5,fillOpacity:.5}:{color:"white",weight:1.5,fillOpacity:.75}},onEachFeature:function(e,t){t.bindPopup("Name: "+e.properties.Name+"<br>Time: "+e.properties.DataZone)}})),i.a.createElement("div",{className:"main"},i.a.createElement(K,{city:this.state.city,method:this.state.method,changeMethod:this.changeMethod,changeCity:this.changeCity}),e,i.a.createElement(H,{method:this.state.method,changeDomain:this.changeDomain,activeDomains:this.state.activeDomains}))}}]),t}(i.a.Component);u.a.render(i.a.createElement(Y,null),document.getElementById("root"))},89:function(e,t,a){}},[[264,1,2]]]);
//# sourceMappingURL=main.96e93157.chunk.js.map